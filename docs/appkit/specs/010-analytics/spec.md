# Spec: 010-analytics

## Feature Name
성과 분석 대시보드

## User Value (고객 가치)
- **투명한 성과 확인**: 캠페인별/페르소나별 도달률, 참여율 실시간 확인
- **자동 리포트**: 광고주에게 성과 리포트 자동 생성 및 전송
- **데이터 기반 최적화**: 성과 좋은 콘텐츠 패턴 분석으로 개선
- **ROI 계산**: 광고 비용 대비 성과 명확히 제시

## Target User (누가 쓸까?)
- **Primary**: 광고주 (캠페인 성과 확인)
- **Secondary**: 서비스 관리자 (전체 성과 모니터링)
- **Use Case**:
  - 진행 중 캠페인 성과 실시간 확인
  - 완료된 캠페인 리포트 다운로드
  - 페르소나별 성과 비교

## User Journey & Screen Flow

### 1. 성과 대시보드 (광고주용)
- **UI Elements**:
  - 상단: 캠페인 선택 드롭다운
  - KPI 카드 4개:
    - 총 도달 수 (Impressions)
    - 참여율 (Engagement Rate)
    - 클릭수 (Link Clicks)
    - 총 비용
  - 차트:
    - 일별 도달 수 그래프
    - 페르소나별 참여율 비교 바 차트
  - 콘텐츠 성과 테이블 (페르소나, 이미지, 도달수, 좋아요, 댓글, 클릭)
- **CTA**: "리포트 다운로드 (PDF)", "상세 보기"
- **Next**: 상세 분석 화면

### 2. 페르소나별 성과 상세
- **UI Elements**:
  - 페르소나 선택
  - 포스팅 히스토리 타임라인
  - 각 포스팅: 이미지, 캡션, 성과 지표
  - 평균 성과 vs 이번 캠페인 성과 비교
  - 베스트 포스팅 (참여율 Top 3)
- **CTA**: "페르소나 비교"
- **Next**: 비교 화면

### 3. 캠페인 성과 리포트 (자동 생성)
- **UI Elements**:
  - 리포트 커버 (브랜드 로고, 캠페인명, 기간)
  - Executive Summary:
    - 총 도달 수, 참여율, ROI
  - 페르소나별 상세:
    - 각 페르소나 성과 1페이지
  - 베스트 콘텐츠 Top 5
  - 다음 캠페인 추천 사항
- **CTA**: "PDF 다운로드", "이메일 전송"
- **Next**: 대시보드

### 4. 관리자 통합 대시보드
- **UI Elements**:
  - 전체 캠페인 현황
  - 월별 매출 그래프
  - 페르소나별 평균 성과 (전체 기간)
  - 광고주별 만족도 점수
  - 시스템 헬스 체크 (포스팅 성공률, API 에러율)
- **CTA**: "월간 리포트 생성"
- **Next**: 상세 분석

## Business Rules

### 성과 데이터 수집 규칙
- **수집 주기**: 포스팅 후 1시간마다 Instagram API 호출
- **수집 기간**: 포스팅 후 7일간 (이후 일별 1회)
- **수집 항목**:
  - Impressions (노출 수)
  - Reach (도달 수)
  - Likes (좋아요)
  - Comments (댓글)
  - Saves (저장)
  - Shares (공유)
  - Link Clicks (링크 클릭) - 광고 콘텐츠만

### 성과 지표 계산
- **참여율 (Engagement Rate)**:
  ```
  (Likes + Comments + Saves + Shares) / Reach * 100
  ```
- **ROI (Return on Investment)**:
  ```
  (Link Clicks * 예상 전환가치 - 광고 비용) / 광고 비용 * 100
  ```
  - 예상 전환가치: 클릭당 1,000원 (기본값, 광고주 설정 가능)

### 리포트 자동 생성 규칙
- **생성 시점**: 캠페인 종료 후 1일
- **전송 방식**: 광고주 이메일 자동 전송
- **포맷**: PDF (A4, 10-20페이지)
- **템플릿**: 브랜드별 커스터마이징 가능

### 베스트 콘텐츠 선정 기준
- **Top 5 선정**: 참여율 상위 5개
- **카테고리별 분석**:
  - 이미지 스타일 (장소, 포즈, 분위기)
  - 캡션 길이
  - 해시태그 개수
  - 포스팅 시간대

## Edge Cases

### 데이터 수집 실패
- Instagram API 오류: 1시간 후 재시도 (최대 5회)
- 계정 삭제/정지: "데이터 수집 불가" 표시

### 성과 데이터 부족
- 포스팅 후 24시간 미만: "데이터 수집 중" 표시
- 도달 수 0: "포스팅 확인 필요" 경고

### 리포트 생성 실패
- PDF 생성 오류: 관리자에게 알림, 수동 생성 요청
- 이메일 전송 실패: 3회 재시도, 광고주 대시보드에서 다운로드 가능 안내

## Dependencies
- **006-brand-site**: 캠페인 정보, 광고주 정보
- **007-ad-content**: 광고 콘텐츠 정보
- **008-posting**: 포스팅 정보 (인스타그램 URL, 포스트 ID)
- **009-engagement**: DM/댓글 상호작용 데이터

## Technical Requirements (초기 추론)
- **API**: Instagram Graph API (Insights)
- **데이터 수집 스케줄러**: Node-cron
- **데이터 저장**: PostgreSQL (시계열 데이터)
- **차트 라이브러리**: Chart.js 또는 Recharts
- **PDF 생성**: Puppeteer 또는 PDFKit
- **이메일 전송**: SendGrid 또는 AWS SES

---

## 💡 더 구체화하려면

```
/appkit.spec 010-analytics "예측 분석 (다음 캠페인 성과 예측)"
/appkit.spec 010-analytics "A/B 테스트 분석 (콘텐츠 스타일별 비교)"
/appkit.spec 010-analytics "경쟁사 벤치마킹 (유사 브랜드 성과 비교)"
/appkit.spec 010-analytics "실시간 알림 (성과 급등/급락 시 알림)"
```
