# Spec: 002-reference-crawl

## Feature Name
레퍼런스 크롤링 및 분석

## User Value (고객 가치)
- **검증된 요소 확보**: 이미 성공한 인플루언서 콘텐츠 요소를 크롤링하여 시행착오 최소화
- **톤앤매너 학습**: 레퍼런스 계정의 캡션 스타일을 자동 분석하여 자연스러운 콘텐츠 생성
- **다양한 소스**: 여러 성공 사례를 조합하여 독창적이면서도 검증된 콘텐츠 제작

## Target User (누가 쓸까?)
- **Primary**: 서비스 관리자 (운영팀)
- **Use Case**:
  - 페르소나별 레퍼런스 인스타 계정 설정
  - 크롤링 결과 확인 및 관리
  - 톤앤매너 분석 결과 검토

## User Journey & Screen Flow

### 1. 레퍼런스 관리 대시보드
- **UI Elements**:
  - 페르소나 목록 (001-persona에서 생성된)
  - 각 페르소나별 레퍼런스 계정 개수
  - 크롤링 상태 (대기/진행중/완료/실패)
  - "새 레퍼런스 추가" 버튼
- **CTA**: "새 레퍼런스 추가", "전체 크롤링 시작"
- **Next**: 레퍼런스 추가 모달 또는 크롤링 결과 화면

### 2. 레퍼런스 계정 추가 모달
- **UI Elements**:
  - 페르소나 선택 드롭다운
  - 인스타그램 계정명 입력
  - 크롤링 옵션 (최근 N개 포스트, 기간 설정)
- **CTA**: "계정 추가 & 크롤링 시작"
- **Next**: 크롤링 진행 화면

### 3. 크롤링 결과 갤러리
- **UI Elements**:
  - 페르소나/레퍼런스 계정 필터
  - 이미지 그리드 뷰 (썸네일)
  - 각 이미지 카드: 이미지, 좋아요 수, 댓글 수, 캡션 미리보기
  - 검색/필터 (장소, 분위기, 제품 유형)
- **CTA**: 이미지 클릭 → 상세 보기
- **Next**: 크롤링 결과 상세 또는 003-content-composer에서 활용

### 4. 크롤링 결과 상세
- **UI Elements**:
  - 원본 이미지
  - 캡션 전문
  - 해시태그 목록
  - AI 분석 결과 (장소, 제품, 포즈, 분위기, 톤앤매너)
  - "콘텐츠 조합에 사용" 체크박스
- **CTA**: "장소로 저장", "제품으로 저장", "포즈로 저장"
- **Next**: 크롤링 갤러리 복귀

### 5. 톤앤매너 분석 대시보드
- **UI Elements**:
  - 페르소나별 톤앤매너 분석 결과
  - 주요 키워드 클라우드
  - 문장 길이 평균, 이모지 사용 빈도
  - 말투 특징 (반말/존댓말, 활발함/차분함)
  - 샘플 캡션 3-5개
- **CTA**: "톤앤매너 적용", "캡션 재생성 테스트"
- **Next**: 004-caption-generator 설정

## Business Rules

### 크롤링 규칙
- **크롤링 대상**: 인스타그램 공개 계정만 가능
- **포스트 수 제한**: 계정당 최근 30-100개 포스트
- **크롤링 간격**: 동일 계정 재크롤링 최소 24시간 간격
- **데이터 수집 항목**:
  - 이미지 URL (원본 해상도)
  - 캡션 전문
  - 해시태그 목록
  - 좋아요/댓글 수 (참고용)
  - 게시 날짜

### AI 분석 규칙
- **이미지 분석 항목**:
  - 장소 유형 (카페, 거리, 실내, 야외 등)
  - 제품 감지 (화장품, 의류, 음식 등)
  - 포즈/구도 (정면, 측면, 전신, 근접 등)
  - 분위기 (밝음, 차분함, 활기참, 고급스러움 등)
- **캡션 분석 항목**:
  - 톤앤매너 (반말/존댓말, 친근함/전문성)
  - 평균 문장 길이
  - 이모지 사용 패턴
  - 주요 키워드 추출

### 저장소 구조
- **이미지 저장**: `/assets/references/[persona-id]/[account-name]/[post-id].jpg`
- **메타데이터**: JSON 형식으로 별도 저장
- **톤앤매너 분석**: 페르소나별로 집계하여 DB 저장

## Edge Cases

### 크롤링 실패 처리
- Private 계정: "비공개 계정은 크롤링 불가" 경고 메시지
- 삭제된 계정: 기존 데이터 유지, 상태 "계정 삭제됨"으로 변경
- Rate limiting: 인스타그램 API 제한 시 자동 대기 후 재시도

### 부적절한 콘텐츠 필터링
- 선정적/폭력적 이미지 자동 감지 및 제외
- 관리자 수동 검토 옵션

### 중복 데이터 처리
- 동일 포스트 재크롤링 시 덮어쓰기 vs 버전 관리
- 유사 이미지 감지 (옵션)

## Dependencies
- **001-persona**: 페르소나 정보 참조 (카테고리, 톤앤매너)
- **연관 기능**:
  - 003-content-composer: 크롤링 결과를 조합 소스로 활용
  - 004-caption-generator: 톤앤매너 분석 결과를 캡션 생성에 활용

## Technical Requirements (초기 추론)
- **크롤링 방식**: Instagram Graph API (공식) 또는 스크래핑 라이브러리
- **이미지 분석**: OpenAI Vision API 또는 Google Vision API
- **텍스트 분석**: GPT-4 기반 톤앤매너 분석

---

## 💡 더 구체화하려면

```
/appkit.spec 002-reference-crawl "크롤링 스케줄 자동화 (주 1회 자동 업데이트)"
/appkit.spec 002-reference-crawl "유사 이미지 클러스터링으로 중복 제거"
/appkit.spec 002-reference-crawl "레퍼런스 계정 추천 기능 (카테고리 기반)"
```
